var __vite_style__=document.createElement("style");__vite_style__.innerHTML="@import url(//unpkg.com/nprogress@0.2.0/nprogress.css);.navbar[data-v-ab18332e]{position:fixed;top:0;width:100%;margin:0;padding:0;overflow:hidden;background-color:#723d67;display:flex}.navbar a[data-v-ab18332e]{display:block;color:#fff;text-align:center;padding:14px 16px;text-decoration:none}.navbar a[data-v-ab18332e]:hover{background-color:#111}.plugin-config[data-v-232092e2]{margin:5px}.plugin[data-v-603fb8da]{margin:10px;width:500px;background-color:#efcda4;border:1px solid #a9a9a9;border-radius:5px}.plugins-manager{background-color:#e1b5a2}.image-upload[data-v-03edc14d]{margin:10px;width:300px;height:500px;background-color:#e1b5a2;border:1px solid #a9a9a9;border-radius:5px}.file-upload[data-v-03edc14d]{margin:10px;width:200px;height:200px;border:1px solid #000;border-radius:5px;display:flex;justify-content:center;align-items:center}.image-preview[data-v-89728f7a]{max-width:640px;max-height:480px;margin:10px;background-color:#efcda4;border:1px solid #a9a9a9;border-radius:5px;overflow-y:scroll;overflow-x:hidden}.image-preview img[data-v-89728f7a]{max-width:640px;max-height:480px}.main[data-v-0253e9f6]{padding:100px;display:flex;background-color:#5a0d33}button[data-v-0253e9f6]{width:350px;color:#fff;background-color:#9c3c53;border:2px solid #a9a9a9;border-radius:15px;font-size:24pt;padding:10px}#app{color:#000}",document.head.appendChild(__vite_style__),System.register(["vue","./vendor.c3cc92a9.js"],(function(){"use strict";var e,a,n,i,t,o,l,s,r,d,g,p,u,c,m,f,h,b,v,y,C,x,w,I,k,_;return{setters:[function(x){e=x.pushScopeId,a=x.popScopeId,n=x.openBlock,i=x.createBlock,t=x.withScopeId,o=x.createVNode,l=x.Fragment,s=x.renderList,r=x.toDisplayString,d=x.withDirectives,g=x.vModelText,p=x.createCommentVNode,u=x.shallowRef,c=x.resolveComponent,m=x.vModelCheckbox,f=x.createTextVNode,h=x.resolveDynamicComponent,b=x.defineComponent,v=x.withCtx,y=x.ref,C=x.createApp},function(e){x=e.V,w=e.v,I=e.j,k=e.F,_=e.n}],execute:function(){const U={name:"Navbar"},j=t("data-v-ab18332e");e("data-v-ab18332e");const P={class:"navbar"},F=o("a",{href:"/"},"Home",-1),M=o("a",{href:"https://github.com/lenna-project"},"Github",-1);a();const L=j(((e,a,t,o,l,s)=>(n(),i("div",P,[F,M]))));U.render=L,U.__scopeId="data-v-ab18332e";var V={name:"PluginConfig",props:{defaultConfig:Object},data:()=>({config:[]}),methods:{async updateConfig(){let e={};for(let a of this.config)e[a.key]=a.value;this.$emit("changeConfig",e)}},created(){for(let e in this.defaultConfig){let a={key:e,value:this.defaultConfig[e]};this.config.push(a)}this.updateConfig()}};const E=t("data-v-232092e2");e("data-v-232092e2");const R={key:0,class:"plugin-config"};a();const S=E(((e,a,t,u,c,m)=>c.config?(n(),i("div",R,[(n(!0),i(l,null,s(c.config,(e=>(n(),i("div",{key:e.key},[o("label",null,r(e.key)+": ",1),d(o("input",{type:"number",placeholder:e.key,"onUpdate:modelValue":a=>e.value=a,onChange:a[1]||(a[1]=e=>m.updateConfig())},null,40,["placeholder","onUpdate:modelValue"]),[[g,e.value,void 0,{number:!0}]])])))),128))])):p("",!0)));V.render=S,V.__scopeId="data-v-232092e2";var A={name:"Plugin",props:{name:String,plugin:Object},components:{PluginConfig:V},data:()=>({ui:u(null),processor:null,enabled:!1,keyCounter:0,pluginKey:"",defaultConfig:null}),methods:{async loadDefaultConfig(){this.plugin.defaultConfig().then((e=>{this.defaultConfig=e}))},async loadUI(){System.import(this.name).then((e=>{e.ui&&(this.ui=(this.name,e.ui),console.log(this.ui))}))},async updateConfig(e){this.$emit("changeConfig",e)},async updateEnabled(e){this.$emit("changeEnabled",e)}},created(){this.loadUI(),this.loadDefaultConfig()},watch:{defaultConfig:{handler:function(e){this.keyCounter+=1,this.pluginKey=this.name+this.keyCounter}}}};const D=t("data-v-603fb8da");e("data-v-603fb8da");const O={key:0,class:"plugin"},N={for:"checkbox"},$={key:0},B={key:0},K={key:1};a();const Z=D(((e,a,t,l,s,g)=>{const u=c("PluginConfig");return t.plugin?(n(),i("div",O,[o("h1",null,[d(o("input",{type:"checkbox",id:"checkbox","onUpdate:modelValue":a[1]||(a[1]=e=>s.enabled=e),onChange:a[2]||(a[2]=e=>g.updateEnabled(s.enabled))},null,544),[[m,s.enabled]]),o("label",N,r(t.plugin.name()),1)]),f(" "+r(t.plugin.description())+" ",1),s.enabled?(n(),i("div",$,[s.ui&&s.defaultConfig?(n(),i("div",B,[(n(),i(h(s.ui),{key:s.pluginKey,defaultConfig:s.defaultConfig,onChangeConfig:a[3]||(a[3]=e=>g.updateConfig(e))},null,8,["defaultConfig"]))])):(n(),i("div",K,[o(u,{key:s.pluginKey,defaultConfig:s.defaultConfig,onChangeConfig:a[4]||(a[4]=e=>g.updateConfig(e))},null,8,["defaultConfig"])]))])):p("",!0)])):p("",!0)}));A.render=Z,A.__scopeId="data-v-603fb8da";const T=b({name:"PluginsManager",props:{pluginsmap:String},components:{Plugin:A,draggable:x},data:()=>({plugins:[]}),beforeMount(){this.getPluginsmap()},methods:{changeEnabled(e,a){this.plugins.find((a=>a.name===e)).enabled=a},changeConfig(e,a){this.plugins.find((a=>a.name===e)).config=a},raw:e=>e,async getPluginsmap(){const e=await fetch(this.pluginsmap),a=await e.json();for(const n in a.imports)System.import(n).then((e=>{this.plugins.push({name:n,url:a.imports[n],plugin:e,enabled:!1,config:{}})}))}}}),z={class:"plugins-manager"};T.render=function(e,a,t,r,d,g){const p=c("Plugin"),u=c("draggable");return n(),i("div",z,[o(u,{class:"dragArea list-group w-full",list:e.plugins},{default:v((()=>[(n(!0),i(l,null,s(e.plugins,(a=>(n(),i("div",{class:"list-group-item",key:a.name},[o(p,{name:a.name,plugin:a.plugin,onChangeEnabled:n=>e.changeEnabled(a.name,n),onChangeConfig:n=>e.changeConfig(a.name,n)},null,8,["name","plugin","onChangeEnabled","onChangeConfig"])])))),128))])),_:1},8,["list"])])};var H=b({components:{FileUpload:w},data:()=>({files:[],image:null}),methods:{inputFile(e,a,n){this.image=e,this.$emit("changeImage",e)},inputFilter(e,a,n){if(e&&!a&&!/\.(gif|jpg|jpeg|png|webp)$/i.test(e.name))return this.alert("Your choice is not a picture"),n();if(e&&(!a||e.file!==a.file)){e.url="";let a=window.URL||window.webkitURL;a&&a.createObjectURL&&(e.url=a.createObjectURL(e.file))}}}});const G=t("data-v-03edc14d");e("data-v-03edc14d");const Y={class:"image-upload"},q=o("h3",null,"Drop or select files",-1);a();const J=G(((e,a,t,l,s,r)=>{const d=c("FileUpload");return n(),i("div",Y,[o(d,{multiple:!0,drop:!0,"drop-directory":!0,extensions:"gif,jpg,jpeg,png,webp",accept:"image/png,image/gif,image/jpeg,image/webp",modelValue:e.files,"onUpdate:modelValue":a[1]||(a[1]=a=>e.files=a),onInputFilter:e.inputFilter,onInputFile:e.inputFile,ref:"upload",class:"file-upload"},{default:G((()=>[q])),_:1},8,["modelValue","onInputFilter","onInputFile"]),e.image?(n(),i("img",{key:0,src:e.image.url,width:"250",height:"250"},null,8,["src"])):p("",!0)])}));H.render=J,H.__scopeId="data-v-03edc14d";var Q={props:{images:Array},methods:{createObjectURL:e=>URL.createObjectURL(e),async downloadZip(){let e=new I;this.images.forEach(((a,n)=>{e.file(`image${n}.png`,a)})),e.generateAsync({type:"blob"}).then((function(e){k.saveAs(e,"images.zip")}))}}};const W=t("data-v-89728f7a");e("data-v-89728f7a");const X={key:0,class:"image-preview"},ee=o("br",null,null,-1);a();const ae=W(((e,a,t,r,d,g)=>t.images.length>0?(n(),i("div",X,[o("button",{onClick:a[1]||(a[1]=(...e)=>g.downloadZip&&g.downloadZip(...e))},"Download as ZIP"),ee,(n(!0),i(l,null,s(t.images,((e,a)=>(n(),i("div",{key:a},[o("img",{src:g.createObjectURL(e)},null,8,["src"])])))),128))])):p("",!0)));Q.render=ae,Q.__scopeId="data-v-89728f7a";var ne=b({name:"App",components:{Navbar:U,PluginsManager:T,ImageUpload:H,ImagePreview:Q},data:()=>({resultImage:null,sourceImage:null,sourceImages:[],resultImages:[]}),setup:()=>({pluginsManager:y(null)}),methods:{changeImages(e){this.sourceImage=e.file,this.sourceImages.push(this.sourceImage)},async processImages(){this.resultImages=[];for(let e of this.sourceImages)this.process(e).then((e=>{this.resultImage=e,this.resultImages.push(e)}));this.sourceImage=null,this.sourceImages=[]},async process(e){_.configure({parent:"#process"}),_.start();let a=new Uint8Array(await e.arrayBuffer());for(let i in this.pluginsManager.plugins){_.inc(.2);let e=this.pluginsManager.plugins[i];e.enabled&&(a=await e.plugin.process(e.config,a))}const n=new Blob([a],{type:"image/png"});return _.done(),_.remove(),n}}});const ie=t("data-v-0253e9f6");e("data-v-0253e9f6");const te={class:"main"},oe={id:"process"};a();const le=ie(((e,a,t,s,r,d)=>{const g=c("Navbar"),u=c("ImageUpload"),m=c("PluginsManager"),f=c("ImagePreview");return n(),i(l,null,[o(g),o("div",te,[o(u,{onChangeImage:a[1]||(a[1]=a=>e.changeImages(a))}),o("div",oe,[e.sourceImage?(n(),i("button",{key:0,onClick:a[2]||(a[2]=(...a)=>e.processImages&&e.processImages(...a))}," >>process image>> ")):p("",!0),o(m,{ref:"pluginsManager",pluginsmap:"https://lenna.app/lenna-plugins/importmap.json"},null,512)]),o(f,{images:e.resultImages},null,8,["images"])])],64)}));ne.render=le,ne.__scopeId="data-v-0253e9f6";C(ne).mount("#app")}}}));
